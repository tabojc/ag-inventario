/*! jWizard v2.0.0 Built: 2013-03-04 */
(function(t){t.widget("db.progressbar",t.ui.progressbar,{_create:function(){this._super?this._super():t.ui.progressbar.prototype._create.call(this),this.options.label&&this._createLabel(),this._refreshValue()},destroy:function(){this.options.label&&this._destroyLabel(),this._super?this._super():t.ui.progressbar.prototype.destroy.call(this)},_refreshValue:function(){this._superApply?this._superApply(arguments):t.ui.progressbar.prototype._refreshValue.apply(this,arguments),this.label&&this._updateLabel()},_setOption:function(e){"value"===e&&this.options.label&&this._updateLabel(),this._superApply?this._superApply(arguments):t.ui.progressbar.prototype._setOption.apply(this,arguments)},_createLabel:function(){this.label||(this.label=t('<span class="ui-progressbar-label"></span>').appendTo(this.element),this._updateLabel())},_updateLabel:function(){var t=this.options,e="count"===t.label?this._count():this._percentage()+"%";t.append&&(e+=" "+t.append),this.label.text(e).position({my:"center",at:"center",of:this.element})},_destroyLabel:function(){this.label.remove(),this.label=null},_count:function(){return this.value()+" of "+this.options.max},options:{label:null,append:!1}}),t.widget("db.jWizard",{$steps:null,$current:null,widgetEventPrefix:"wizard",_create:function(){var e=this.options;this._super?this._super():t.Widget.prototype._create.call(this),e.disabled&&this.disable(),this.element.addClass("ui-widget jw-widget"),this._buildSteps(),e.title&&this._buildTitle(),e.menu&&this._buildMenu(),this._buildButtons(),e.progress&&this._buildProgress()},destroy:function(){var e=this.options;this.element.removeClass("ui-widget jw-widget jw-hasprogress"),e.progress&&this._destroyProgress(),this._destroyButtons(),e.menu&&this._destroyMenu(),e.title&&this._destroyTitle(),this._destroySteps(),this._super?this._super():t.Widget.prototype.destroy.call(this)},first:function(){return this.step(this.$steps.first())},last:function(){return this.step(this.$steps.last())},cancel:function(){this._trigger("cancel")},prev:function(){return this.step(this.$current.prev())},next:function(){return this.step(this.$current.next())},finish:function(){this._trigger("finish")},step:function(e){function s(){n._enter(n.$current).then(r.resolve,r.reject)}function i(){n._enableButtons(),r.resolve()}var n=this,r=t.Deferred();return"number"==typeof e&&(e=this.$steps.eq(e)),this._disableButtons(),this._leave(this.$current).then(function(){n._enter(e).then(i,s)},s),r.promise()},_leave:function(e){function s(){e.trigger("stephidden"),n.resolve()}var i=t.Event("stephide"),n=t.Deferred(),r=this.options.effects.steps.hide;return e?(e.trigger(i),i.isDefaultPrevented()?n.reject():this._hide?this._hide(e,r,s):e.hide(r,s)):n.resolve(),n.promise()},_enter:function(e){function s(){i.$current=e,i._updateTitle(),i._updateMenu(),i._updateButtons(),i._updateProgress(),e.trigger("stepshown"),r.resolve()}var i=this,n=t.Event("stepshow"),r=t.Deferred(),o=this.options.effects.steps.show;return e?(e.trigger(n),n.isDefaultPrevented()?r.reject():this._show?this._show(e,o,s):e.show(o,s)):r.resolve(),r.promise()},_buildTitle:function(){this.$title||(this.$title=t('<h2 class="jw-title" />'),this.$header=t('<div class="jw-header ui-widget-header ui-corner-top ui-helper-clearfix">').append(this.$title).prependTo(this.element),this._updateTitle())},_updateTitle:function(){var t=this.$title;t&&t.text(this.$current.data("jwizard-title"))},_destroyTitle:function(){this.$header.remove(),this.$title=this.$header=null},_buildSteps:function(){var e=this.$steps=this.element.children();e.addClass("jw-step").each(function(){var e,s=t(this);e=s.is("fieldset")?s.find("legend").text():s.attr("title"),e&&s.data("jwizard-title",e)}),e.hide().wrapAll(t("<div />",{"class":"jw-content ui-widget-content ui-helper-clearfix",html:'<div class="jw-steps-wrap" />'})),this.$current=this.$steps.first().show()},_destroySteps:function(){this.$steps.show().unwrap().unwrap().removeData("jwizard-title").removeClass("jw-step"),this.$steps=null},_buildMenu:function(){var e=this;this.element.addClass("jw-hasmenu"),this.$menu||(this.$menu=t("<ol>",{"class":"jw-menu",html:t.map(this.$steps,function(e){var s=t(e).data("jwizard-title");return'<li><a href="javascript:void(0);">'+s+"</a>"}).join("")}).menu({select:function(t,s){e.step(s.item.index())}}),this.$menuWrap=t('<div class="jw-menu-wrap">').append(this.$menu).prependTo(this.element.children(".jw-content")),this._updateMenu())},_updateMenu:function(){if(this.$menu){var t=this.$current.index();this.$menu.children("li").removeClass("ui-state-highlight ui-state-disabled").eq(t).addClass("ui-state-highlight").end().slice(t).addClass("ui-state-disabled")}},_destroyMenu:function(){this.element.removeClass("jw-hasmenu"),this.$menu.menu("destroy"),this.$menuWrap.remove(),this.$menu=this.$menuWrap=null},_buildProgress:function(){if(!this.$progress){var e=t.extend({},this.options.progress),s=e.location,i=t("<div>").appendTo(this.element.find(s));delete e.location,e.max=this.$steps.length,this.element.addClass("jw-hasprogress"),this.$progress=i.progressbar(e).addClass("jw-progress"),this._updateProgress()}},_updateProgress:function(){if(this.$progress){var t=this.$current,e=t?t.index():0;this.$progress.progressbar("value",e)}},_destroyProgress:function(){this.element.removeClass("jw-hasprogress"),this.$progress.progressbar("destroy").remove(),this.$progress=null},_buildButtons:function(){var e=this,s=t("<div>",{"class":"jw-footer ui-widget-header ui-corner-bottom",html:'<div class="jw-buttons ui-helper-clearfix"></div>'});t.each(this.options.buttons,function(i,n){var r=t.extend({},n),o=r.icons;delete r.icons,r.class=r["class"]||"",r.class+=" jw-button-"+i,n&&(e["$"+i]=t("<button>",r).button({icons:o}).appendTo(s.children(".jw-buttons")))}),this.element.append(s),this._on?this._on({"click .jw-button-cancel":function(){e.cancel()},"click .jw-button-prev":function(){e.prev()},"click .jw-button-next":function(){e.next()},"click .jw-button-finish":function(){e.finish()}}):this.element.on("click",".jw-button-cancel",function(){e.cancel()}).on("click",".jw-button-prev",function(){e.prev()}).on("click",".jw-button-next",function(){e.next()}).on("click",".jw-button-finish",function(){e.finish()}),this._updateButtons()},_updateButtons:function(){var t=this.$steps,e=this.$current,s=this.$prev,i=this.$next,n=this.$finish;switch(e.index()){case 0:s.hide(),i.show(),n.hide();break;case t.length-1:s.show(),i.hide(),n.show();break;default:s.show(),i.show(),n.hide()}},_destroyButtons:function(){this.element.find(".jw-footer").remove()},_disableButtons:function(){this.element.find(".jw-footer").find("button").addClass("ui-state-disabled")},_enableButtons:function(){this.element.find(".jw-footer").find("button").removeClass("ui-state-disabled")},option:function(e,s){if(this._superApply)this._superApply(arguments);else if(1>arguments.length||-1===e.indexOf("."))t.Widget.prototype.option.apply(this,arguments);else{var i=this.options,n=e.split("."),r=n.length-1;t.each(n,function(t,e){t>=r?i[e]=s:i=i[e]}),this._setOption(n[0],s)}},_setOption:function(e,s){switch(this._superApply?this._superApply(arguments):"disabled"===e&&t.Widget.prototype._setOption.apply(this,arguments),e){case"title":this[s?"_buildTitle":"_destroyTitle"]();break;case"menu":this[s?"_buildMenu":"_destroyMenu"]();break;case"buttons":this._destroyButtons(),this._buildButtons();break;case"progress":this._destroyProgress(),this._buildProgress()}},options:{title:!0,menu:!0,buttons:{cancel:{"class":"ui-priority-secondary",text:"Cancel",type:"reset",icons:{primary:"ui-icon-circle-close"}},prev:{text:"Previous",type:"button",icons:{primary:"ui-icon-circle-triangle-w"}},next:{text:"Next",type:"button",icons:{secondary:"ui-icon-circle-triangle-e"}},finish:{"class":"ui-priority-primary ui-state-highlight",text:"Finish",type:"submit",icons:{secondary:"ui-icon-circle-check"}}},progress:{label:"count",append:"Complete",location:".jw-header"},effects:{steps:{hide:{effect:"blind",direction:"left",duration:250},show:{effect:"blind",direction:"left",duration:250}}}}})})(jQuery);